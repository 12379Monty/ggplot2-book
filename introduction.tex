\input{header.tex}

% \setchapterpreamble[u]{% 
% \dictum[Anonymous]{Forecasting is the art of saying 
% what is going to happen and then to explain 
% why it didnâ€™t.}} 

% what is ggplot
% how to get ggplot
% how does it fit in with other r packages (including comparison table)
% what is the grammar of graphics etc? what the grammar doesn't do
% outline of book
% formatting conventions

\chapter{Introduction}

Ggplot is an R package for producing statistical graphics.  It builds on the grid graphics system [ref], and uses the philosophy outlined in the Grammar of Graphics [ref] to produce a powerful and flexible plotting system that is still easy to use.  This model of graphics is quite different to the existing base and lattice graphic system and so you'll need to learn a new way of thinking about graphics.  This book provides helps you to do this as well as providing a practical introduction to Ggplot with lots of example code and graphics.

\section{What is the grammar of graphics?}

The grammar of graphics is a way of describing a plot.

A graphic is a mapping from data to aesthetic attributes of geometric objects.  The plot may also contain statistical transformations of the data, and is drawn on a specific coordinate system.  Facetting is used to generate the same plot for different subsets of the dataset.

A plot is made up of the following components:

\begin{itemize}
	\item Data: the most important thing, and the thing that 
	\item Scales
	\item Statistics
	\item Geometric objects (geoms for short)
	\item A coordinate system
	\item Facetting specification
\end{itemize}

My view of the grammar has diverged somewhat from that described in Lee's book.  I will try and highlight places in the text where the divergence is particularly profound.

It is also important to talk about what the grammar doesn't do:

\begin{itemize}
	\item It doesn't specify what a good graphic is.  It doesn't offer any guidance in what variables should be mapped to what aesthetic properties.  It describes what a valid plot is, and many valid plots are quite hideous and useless.

	\item Ironically, it doesn't actually specify what a graphic should look like.  The finer points of display, for example font size or background colour, are not specified by the grammar.  In practice to create a useful plotting system we will need to describe these in some way.

	\item It does not describe interaction - the grammar of graphics describes purely static graphics, and there essentially no benefit to displaying on a computer screen as opposed to on a piece of paper.
\end{itemize}

\section{How does ggplot fit in with other R graphics?}

There are a number of other graphics systems available in R: base graphics, grid graphics and trellis/lattice graphics.  How does ggplot from them?

\begin{itemize} 
	\item The problem with base graphics is that it's basically a pen on paper model: you can only draw on top, not modify or delete existing content or change the axes etc.  Base graphics includes both tools for drawing primitives and entire plots. No other plotting system does this.

	\item Grid graphics are a big step up from the drawing capabilities of base graphics. The plot objects can be represented independently of the plot and modified later on. A system of viewports (each containing its own coordinate system) makes it easier to layout complex graphics.

	\item Trellis/lattice uses grid graphics, and is a considerable improvement over base graphics.  The chief advantage of lattice over base graphics is that you can easily produce trellised (or conditioned) plots.  A trellised plot reproduces the same plot for different subsets of the data, a type of small multiple.  Lattice graphics also provide automatic legends, and a range of 3D plots.  However, lattice graphics does not use a formal model of graphics, which can make it hard to extend.

	\item ggplot is an attempt to take the good things about base and lattice graphics and improve on them by having a model which supports the production of any kind of statistical graphic, build on principles outlined in the Grammar of Graphics.  The chief advantage of ggplot are that it has a solid underlying model.  This makes it easy to describe a wide range of graphics with a compact syntax, and separates out different components to make extension easier.  ggplot uses grid to draw the graphics, which means you can exercise a huge amount of low level control over the appearance of the plot

	\item Many other R packages implement specialist graphics but no others provide a framework for producing statistical graphics. While this is fine if you just want to produce a one-off graphic, it is generally hard to combine these with other graphics you may be using.
\end{itemize}

\section{About this book}\label{sec:about_this_book}

% This book is available online for free at \url{http://had.co.nz/ggplot/book}.  However, if you want to support the development of ggplot (and save yourself the hassle of printing and binding a large pdf) you can also buy a printed version for \$US 40 (price may change).  

The ggplot website, \url{http://had.co.nz/ggplot}, provides updates to this book, information about features in the latest version of ggplot, and talks and papers related to ggplot.  All graphics used on the book are listed, along with the code and data needed to reproduce them.  There is also a gallery of example graphics used in real life: if you would like your graphics to be included in the gallery, please send me reproducible code and a paragraph or two describing your plot.

The book is structured to lead you from a new user of ggplot to a developer creating new components for specialised plots:

\begin{itemize}
	\item In Chapter One I describe how you can quickly get started using {\tt qplot} to make graphics, just like you can using {\tt plot}.  This chapter introduces several important ggplot concepts: grob functions, aesthetic mappings and facetting.
	
	\item While {\tt qplot} is a quick way to get started, it doesn't give full control over all the  available options, so Chapter Two describes how to build up a plot piece by piece, exercising full control over the available options.  This chapter discusses the components of a plot, laying the ground for the following chapters which describe these components in detail, and teach you how to build your own.  You will also learn some techniques using the reshape package to get data into a form convenient for using with ggplot.

	\item The most crucial component of a plot are the geom and statistic objects, and Chapters Three and Four describes what they do, how they work, and lists the most commonly used.  Mastery of this chapter will give you the ability to pick and choose the most appropriate tool for your visual display needs.  The chapter concludes by showing you how to build your own grob function so that you can begin to extend {\tt gplot}.

	\item Understanding how scales works is crucial for fine tuning the perceptual properties of your plot.  Customising scales gives fine control over the exact appearance of the plot, and helps to support the story that you are telling.  Chapter Five will show you what scales are available, how to adjust their parameters, and how to create your own if no built-in scale meets your needs.

	\item You could live your whole life without ever bothering with coordinate systems, but when you need them, its hard to go without.  In Chapter Six
	
	\item Chapter Seven introduces my philosophy of data.  This chapter isn't crucial, but will help you understand the type of data {\tt ggplot} expects, and how to transform your data into that format.  It also discusses facetting in more detail, and discusses some ideas for combining modelling and graphics.
	
	\item Sometimes you need even more control over the output than {\tt ggplot} provides.  In this case, you need to modify the low level grid output that {\tt ggplot} uses to draw the graphics.  In Chapter Eight, you will how the output is built up, how to control and modify the output, and how to add additional annotations to the plot.

\end{itemize}

\section{Installation}\label{sub:installation}

To get started using ggplot, the first thing you need to do is install it.  Make sure you have a recent version of R from \url{http://r-project.org}, and then follow the instructions below to download and install the ggplot package.  If you are not familiar with R, I'd suggest you get a good an R book (I'd recommend XXX) and work through it along with this book.

There are usually two versions of ggplot available, one stable version and one development version. The stable version is well-tested and well-documented before release.  It is available on CRAN, and can be installed with the following R code:

\begin{verbatim}
	install.packages("ggplot", dep=TRUE)
\end{verbatim}

The development version is not so well tested or documented, but includes new features that I'm working on.  It may also contain bug fixes for recently discovered bugs.  It can be installed as follows:

\begin{verbatim}
	install.packages("ggplot", repos="http://www.ggobi.org/r", dep=TRUE)
\end{verbatim}

A changelog listing changes between versions is available on the ggplot website.  I will do my best to make sure that changes are backward compatible, so you shouldn't have to rewrite your old code.  However, from time to time, I may need to make bigger changes that do affect your code.  If you need to ensure that your old code will continue to run, I would recommend using use R's versioned installs:

\begin{verbatim}
	install.packages("ggplot", dep=TRUE, installWithVers=TRUE))
\end{verbatim}

Now installed packages will have a version number associated with them, and you can load a specific version like so:

\begin{verbatim}
	library(ggplot, version="0.3.3")
\end{verbatim}

\section{Problems}\label{sec:problems}

{\tt ggplot} isn't perfect (yet!), so from time-to-time you may encounter something that doesn't way the way you think it should.  If this happens, please email me \href{mailto:h.wickham@gmail.com}{h.wickham@gmail.com} a reproducible example of your problem, as well as a description of what you think should happen.  The more information you provide, the more likely I am going to be able to help you.



\section{Why a new plotting system?}\label{sec:why_a_new_plotting_system_} 

Why do we need a new way of describing graphics?  Why should you bother learning a new way of thinking about graphics?

\section{Acknowledgements}\label{sec:acknolwedgements}

I would like to thank: Gabor Grothendienk for early helpful comments.

\input{footer.tex}
